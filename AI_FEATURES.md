# AI Features in CodeClash

CodeClash leverages **Google Gemini AI** to provide intelligent, personalized coding challenges and post-match analysis. This document outlines the AI-powered features integrated into the platform.

## Features

### 1. AI-Generated Coding Problems

Problems are dynamically generated based on user profiles, ensuring appropriate difficulty and engagement levels.

#### How It Works
- When a user enters a battle or practice mode, Gemini AI generates a unique coding problem
- Problems are tailored based on:
  - **League**: Unranked, Bronze, Silver, Gold, Crystal, Master, Champion, Legend
  - **Level**: User's current skill level (1-âˆž)
  - **XP**: Total experience points earned

#### Difficulty Mapping
- **Unranked/Bronze League**: Easy problems (beginner-friendly)
- **Silver/Gold League**: Easy to Medium (intermediate algorithms)
- **Crystal/Master League**: Medium (solid algorithmic knowledge required)
- **Champion/Legend League**: Hard (expert-level challenges)

#### Problem Structure
Each AI-generated problem includes:
- Unique title and description
- Clear examples and explanations
- 3-5 test cases (mix of visible and hidden)
- Constraints and requirements
- Appropriate time limits (300-600ms)
- XP rewards based on difficulty (Easy: 30-50, Medium: 60-100, Hard: 120-200)

### 2. AI-Powered Post-Match Editorials

After each battle, users receive comprehensive, modern editorials generated by Gemini AI.

#### Editorial Components
- **Problem Summary**: Brief explanation of core concepts
- **Optimal Approach**: Step-by-step solution strategy
- **Example Solution**: Clean, well-commented code (JavaScript/Python)
- **Complexity Analysis**: Time and space complexity breakdown
- **Key Takeaways**: 3-5 important learning points
- **Common Mistakes**: 2-4 pitfalls to avoid

#### When Editorials Are Generated
- Practice mode completion (all tests passed)
- Ranked battle completion
- Friend challenges
- Battle timeouts and forfeits

#### Editorial Features
- Personalized to the user's solution when available
- Contextual feedback based on submission quality
- Modern, encouraging tone to promote learning
- Stored with the problem for future reference

### 3. Langfuse Integration (compilerd)

The compilerd service uses Langfuse for AI observability and tracking:
- Monitors AI generations
- Tracks token usage
- Provides performance metrics
- Enables prompt optimization

## Implementation Details

### Backend Service

**File**: `backend/services/geminiService.js`

Key functions:
- `generateProblem(userProfile)`: Creates unique coding challenges
- `generateEditorial(problem, solution, battleData)`: Generates post-match analysis
- `generateHint(problem)`: Provides hints (future feature)

### API Integration

**Gemini API**: `gemini-1.5-flash` model
- Fast response times
- High-quality content generation
- Cost-effective for scale

### Environment Variables

**Backend** (`.env`):
```env
GEMINI_API_KEY=your_gemini_api_key_here
```

**Compilerd** (`.env`):
```env
GEMINI_API_KEY=your_gemini_api_key_here
LANGFUSE_PUBLIC_KEY=your_langfuse_public_key
LANGFUSE_SECRET_KEY=your_langfuse_secret_key
LANGFUSE_BASE_URL=https://cloud.langfuse.com
```

## User Experience

### For Players

1. **Matchmaking/Practice**
   - System generates a personalized problem
   - Difficulty matches player's league and level
   - Fresh, unique challenges every time

2. **During Battle**
   - Standard coding challenge experience
   - Real-time code execution
   - Test case validation

3. **Post-Battle**
   - Immediate AI-generated editorial
   - Learn optimal solutions
   - Understand time/space complexity
   - Avoid common mistakes

### Benefits

- **Personalized Learning**: Problems match skill level
- **Unlimited Content**: Never run out of challenges
- **Educational Value**: Learn from AI-generated insights
- **Modern Experience**: State-of-the-art AI assistance
- **Continuous Improvement**: Editorial helps players level up

## Migration from Seed Problems

The system has transitioned from static seed problems to AI-generated content:

- âœ… Removed `seedProblems.js` script
- âœ… Problems generated on-demand
- âœ… Each battle gets unique challenges
- âœ… Fallback to existing problems if AI generation fails

## Future Enhancements

Planned AI features:
- **Hint System**: AI-generated hints during battles
- **Code Review**: Detailed analysis of submitted solutions
- **Personalized Learning Paths**: AI-recommended problem sequences
- **Difficulty Adaptation**: Real-time difficulty adjustment based on performance
- **Multi-language Editorials**: Support for user's preferred programming language

## Technical Notes

### Error Handling
- AI generation failures fallback to existing problems
- Editorial generation errors use default templates
- Robust error logging for debugging

### Performance
- Problems cached in database after generation
- Async generation doesn't block battle creation
- Optimized prompts for fast response times

### Observability
- Langfuse tracks all AI interactions
- Metrics available for optimization
- Usage monitoring and cost tracking

---

**Powered by Google Gemini AI** ðŸ¤–
